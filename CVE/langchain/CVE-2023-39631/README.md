```sh
$ docker build -t cve-2023-39631 .
$ docker run -itd cve-2023-39631
```

```py
def _evaluate_expression(self, expression: str) -> str:
    try:
        local_dict = {"pi": math.pi, "e": math.e}
        output = str(
            numexpr.evaluate(
                expression.strip(),
                global_dict={},  # restrict access to globals
                local_dict=local_dict,  # add common mathematical functions
            )
        )
```

https://github.com/langchain-ai/langchain/blob/2c2fd9ff1337e655e3ed2b6d2fe41958debbf564/libs/langchain/langchain/chains/llm_math/base.py#L80

https://www.skshieldus.com/download/files/download.do?o_fname=Research%20Technique%2010%EC%9B%94%ED%98%B8_RCE%20vulnerability%20(CVE-2023-38860%2C%20CVE-2023-39659%2C%20CVE-2023-39631)%20exploiting%20the%20defects%20of%20the%20LangChain%20package.pdf&r_fname=20231027171327418.pdf      